# Описание дашбордов КПЭ и ППР

Документ описывает дашборды (аналитические панели) для визуализации данных таблиц **КПЭ** (контрольные показатели эффективности) и **ППР** (показатели проектной работы). Данные берутся из таблиц на вкладках «КПЭ» и «ППР» соответственно.

---

## 1. Дашборды КПЭ

Вкладка **«Дашборды»** в приложении строит визуализации по данным таблицы **КПЭ** (ключ хранения: `kpi-cascading-kpi-goals`). Колонки таблицы: ФИО, SCAI Цель, Метрические цели, вес квартал, вес год, 1–4 квартал, Год.

### 1.1. Сводка (карточки)

- **Целей (строк)** — общее число записей в таблице КПЭ.
- **Сотрудников (ФИО)** — число уникальных значений в колонке ФИО.
- **С заполненным годом** — число строк, в которых заполнена колонка «Год».
- **С весом года (%)** — число строк с числовым процентом в колонке «вес год» (значения «М» и пустые не считаются).

### 1.2. Распределение весов по целям (горизонтальные полосы)

- Для каждой метрической цели (или SCAI-цели, если метрическая пуста) с числовым весом года отображается горизонтальная полоса.
- Длина полосы пропорциональна весу (в %); справа выводится значение в процентах.
- Позволяет сравнить вклад целей по весу в общую систему КПЭ.

### 1.3. Распределение весов (круговая диаграмма)

- Круговая (донат) диаграмма по тем же данным, что и в п. 1.2.
- Сегменты соответствуют целям с числовым весом года; в центре показывается сумма весов или значение выбранного сегмента при наведении.
- Интерактивность: наведение на сегмент или элемент легенды подсвечивает сегмент и показывает подсказку; клик по легенде фиксирует выбор.

### 1.4. Тепловая карта: наличие данных по кварталам

- Таблица: строки — метрики (до 12 первых), столбцы — Q1, Q2, Q3, Q4.
- В ячейке показывается наличие/значение по соответствующему кварталу; заполненные ячейки выделены цветом, пустые — нейтрально с прочерком.
- Даёт быстрый обзор полноты квартальных данных по показателям.

### 1.5. Цели по сотрудникам (ФИО)

- Горизонтальные бары: топ-10 ФИО по количеству целей (строк).
- Длина бара — относительная (доля от максимума), справа — абсолютное число целей.
- Показывает распределение нагрузки по целям между сотрудниками.

### 1.6. Заполненность данных (%)

- Для каждого поля (ФИО, SCAI Цель, Метрические цели, вес квартал, вес год, 1–4 квартал, Год) вычисляется доля непустых значений в процентах от числа строк.
- Отображается прогресс-бар и процент; цвет зависит от уровня заполненности (например, зелёный — высокая, жёлтый — средняя, красный — низкая).
- Используется для оценки полноты и качества ввода данных КПЭ.

### 1.7. Динамика по кварталам (пример)

- Столбчатая диаграмма по кварталам Q1–Q4 для одной метрики (первая строка с числовыми значениями в кварталах).
- Высота столбцов — нормализованные значения; под столбцами подписаны кварталы и исходные значения.
- Даёт пример квартальной динамики по одному из показателей.

### 1.8. Группировка по SCAI-цели

- Группировка строк по полю «SCAI Цель»: для каждой группы показывается название цели, число метрик (строк) и сумма весов года (если есть числовые веса).
- Отображаются топ-8 групп по числу метрик в виде карточек.
- Позволяет видеть структуру КПЭ по типам целей.

### 1.9. Сводная таблица (метрика, вес года, год)

- Таблица: метрическая цель (или SCAI-цель), вес года, годовое значение.
- Содержит все строки таблицы КПЭ в компактном виде для просмотра и проверки.

---

## 2. Дашборды ППР

Данные таблицы **ППР** (вкладка «ППР», ключ хранения: `kpi-cascading-goals`) имеют ту же структуру полей, что и КПЭ: ФИО, SCAI Цель, Метрические цели, вес квартал, вес год, 1–4 квартал, Год. Поэтому к ним применимы те же типы визуализаций.

### 2.1. Применимость визуализаций к ППР

| Тип дашборда | Применимость к ППР | Комментарий |
|--------------|--------------------|-------------|
| Сводка (карточки) | Да | Цели (строки), сотрудники (ФИО), заполненность года и весов — по таблице ППР. |
| Распределение весов (полосы и круговая) | Да | Веса года по целям/вехам ППР. |
| Тепловая карта по кварталам | Да | Наличие/значения по кварталам для вех ППР. |
| Цели по сотрудникам | Да | Число целей/вех на каждого ФИО. |
| Заполненность данных | Да | Качество заполнения полей таблицы ППР. |
| Динамика по кварталам | Да | Квартальные значения по выбранной цели/вехе ППР. |
| Группировка по SCAI-цели | Да | Группы целей ППР с числом метрик и суммой весов. |
| Сводная таблица | Да | Метрика/веха, вес года, год. |

### 2.2. Специфика ППР

- В ППР колонки «Метрические цели» и кварталы часто отражают **вехи проектов** (сроки, этапы), а не только числовые KPI.
- Веса могут быть распределены по кварталам и году для контроля выполнения вех.
- Дашборды по ППР целесообразно подписывать в интерфейсе как «ППР» (например, «Сводка ППР», «Распределение весов ППР»), если на одной странице выводятся и КПЭ, и ППР.

### 2.3. Реализация в приложении

Сейчас вкладка «Дашборды» строит все визуализации **только по данным КПЭ**. Чтобы получить дашборды по ППР, можно:

- добавить переключатель «КПЭ / ППР» на странице дашбордов и подставлять либо `getKpiState()`, либо `getGoalsState()`; или
- вынести дашборды ППР в отдельную подвкладку/блок и использовать `getGoalsState()` для всех виджетов в этом блоке.

Структура данных (поля строки) совпадает, поэтому логика расчётов и отображения остаётся той же.

---

## 3. Идеи развития

- **Фильтр по ФИО или по SCAI-цели** — пересчёт всех дашбордов для отфильтрованного набора строк.
- **Дерево целей** — каскад «руководитель → подразделения / сотрудники» с весами и агрегатами.
- **План vs факт** — при появлении фактических значений сравнение с плановыми (например, годовой план и факт по метрике).
- **Экспорт дашбордов** — выгрузка сводных таблиц или графиков в Excel/PDF для отчётов.

---

*Документ актуален для приложения kpi-agent-front. Источник данных: таблицы КПЭ и ППР (localStorage).*
